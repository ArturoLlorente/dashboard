<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Server Dashboard</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>

<body>
  <div class="container">
    <div class="header">
      <div class="title">
        <h1>Server Dashboard</h1>
      </div>

      <div class="top-right">
        <div class="battery-hero" title="Battery status">
          <div class="battery-left">
            <div class="battery-big">
              <span class="pct" id="battery-hero-pct">--%</span>
              <span class="arrow" id="battery-hero-arrow">‚Ä¢</span>
            </div>
            <div class="battery-sub" id="battery-hero-status">--</div>
          </div>
          <div class="battery-bar"><div id="battery-hero-bar"></div></div>
        </div>

        <div class="chip">
          <span class="dot" id="status-dot"></span>
          <span>Last update:</span>
          <span id="last-update">Never</span>
        </div>
      </div>
    </div>

    <div class="main-layout">
      <!-- Sidebar Navigation -->
      <div class="sidebar">
        <div class="sidebar-title">Navigation</div>
        <div class="nav-item active" onclick="switchWindow('metrics')">
          <span class="nav-icon">üìä</span>
          <span>System Metrics</span>
        </div>
        <div class="nav-item" onclick="switchWindow('controls')">
          <span class="nav-icon">‚öôÔ∏è</span>
          <span>Controls & Services</span>
        </div>
        <div class="nav-item" onclick="switchWindow('tmux')">
          <span class="nav-icon">üñ•Ô∏è</span>
          <span>Tmux Sessions</span>
        </div>
      </div>

      <!-- Content Area -->
      <div class="content-area">
        <!-- System Metrics Window -->
        <div class="window active" id="window-metrics">
          <div class="section">
            <div class="section-title">System Metrics</div>
            <div class="grid">
              <!-- CPU (historic line) -->
              <div class="card">
                <h2><span>CPU Usage</span><span class="pill ok" id="cpu-pill">OK</span></h2>
                <div class="kpi"><div class="value" id="cpu-kpi">--</div><div class="unit">%</div></div>
                <div class="chart-wrap"><canvas id="cpuChart"></canvas></div>
              </div>

              <!-- Memory (historic line) -->
              <div class="card">
                <h2><span>Memory</span><span class="pill ok" id="mem-pill">OK</span></h2>
                <div class="kpi"><div class="value" id="mem-kpi">--</div><div class="unit">%</div></div>
                <div class="chart-wrap"><canvas id="memChart"></canvas></div>
                <div class="progress"><div id="mem-progress"></div></div>
                <div class="progress-meta"><span>Used / Total</span><span id="mem-info">--</span></div>
              </div>

              <!-- Temperature (historic line) -->
              <div class="card">
                <h2><span>Temperature</span><span class="pill ok" id="temp-pill">OK</span></h2>
                <div class="kpi"><div class="value" id="temp-kpi">--</div><div class="unit">¬∞C</div></div>
                <div class="chart-wrap"><canvas id="tempChart"></canvas></div>
              </div>

              <!-- Battery History (historic line) -->
              <div class="card">
                <h2><span>Battery History</span><span class="pill ok" id="battery-pill">HISTORY</span></h2>
                <div class="kpi"><div class="value" id="battery-hist-kpi">--</div><div class="unit">%</div></div>
                <div class="chart-wrap"><canvas id="batteryChart"></canvas></div>
              </div>

              <!-- Disk (speedometer-like gauge) -->
              <div class="card">
                <h2><span>Disk</span><span class="pill ok" id="disk-pill">OK</span></h2>
                <div class="chart-wrap gauge-wrap" style="height:220px; position:relative; overflow:visible;">
                  <canvas id="diskGauge"></canvas>
                  <div class="gauge-center">
                    <div class="big"><span id="disk-kpi">--</span>%</div>
                    <div class="small" id="disk-info">--</div>
                  </div>
                </div>
              </div>

              <!-- Network (rate line KB/s) -->
              <div class="card">
                <h2><span>Network</span><span class="pill ok" id="net-pill">OK</span></h2>
                <div class="rows">
                  <div class="stat"><span class="stat-label">IP address</span><span class="stat-value" id="net-ip">--</span></div>
                </div>
                <div class="chart-wrap" style="margin-top:10px"><canvas id="netChart"></canvas></div>
                <div class="rows" id="network-interfaces" style="margin-top:10px"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Controls & Services Window -->
        <div class="window" id="window-controls">
          <div class="section">
            <div class="section-title">Controls & Services</div>
            <div class="grid">
              <!-- Services -->
              <div class="card">
                <h2><span>Services</span><span class="pill ok" id="svc-pill">OK</span></h2>
                <div class="rows" id="services-list">
                  <div class="stat"><span class="stat-label">Loading</span><span class="stat-value">...</span></div>
                </div>
              </div>

              <!-- IPTV -->
              <div class="card">
                <h2><span>IPTV</span><span class="pill ok" id="iptv-pill">OK</span></h2>
                <div id="iptv-content" class="rows">
                  <div class="stat"><span class="stat-label">Username</span><span class="stat-value" id="iptv-username">--</span></div>
                  <div class="stat"><span class="stat-label">Active / Max</span><span class="stat-value" id="iptv-connections">--</span></div>
                  <div class="stat"><span class="stat-label">Status</span><span class="stat-value" id="iptv-status">--</span></div>
                  <div class="stat"><span class="stat-label">Expires</span><span class="stat-value" id="iptv-expires">--</span></div>
                </div>
              </div>

              <!-- Brightness -->
              <div class="card">
                <h2><span>Brightness</span><span class="pill ok" id="bright-pill">CONTROL</span></h2>
                <div class="kpi"><div class="value" id="brightness-kpi">--</div><div class="unit">%</div></div>
                <input type="range" min="0" max="100" value="50" id="brightness-slider">
                <div class="btnrow">
                  <button class="btn" onclick="setBrightness(0)">Min</button>
                  <button class="btn" onclick="setBrightness(50)">50%</button>
                  <button class="btn" onclick="setBrightness(100)">Max</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Tmux Sessions Window -->
        <div class="window" id="window-tmux">
          <div class="section">
            <div class="section-title">Tmux Sessions</div>
            <div class="grid">
              <!-- Tmux Overview -->
              <div class="card">
                <h2><span>Overview</span><span class="pill ok" id="tmux-pill">OK</span></h2>
                <div class="rows">
                  <div class="stat"><span class="stat-label">Total Sessions</span><span class="stat-value" id="tmux-total">--</span></div>
                  <div class="stat"><span class="stat-label">Active Sessions</span><span class="stat-value" id="tmux-active">--</span></div>
                  <div class="stat"><span class="stat-label">Total Windows</span><span class="stat-value" id="tmux-windows">--</span></div>
                  <div class="stat"><span class="stat-label">Total Panes</span><span class="stat-value" id="tmux-panes">--</span></div>
                </div>
              </div>
              
              <!-- Session List -->
              <div class="card" style="grid-column: span 2;">
                <h2><span>Sessions</span></h2>
                <div id="tmux-sessions-list">
                  <div class="stat"><span class="stat-label">Loading...</span><span class="stat-value">--</span></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="footer">Auto-refresh every 5 seconds</div>
  </div>

  <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>
</html>
